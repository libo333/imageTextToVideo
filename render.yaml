# Render.com 部署配置文件
# 官方文档: https://render.com/docs/blueprint-spec

services:
  # Web 服务 - Bot + Web App
  - type: web
    name: telegram-video-bot
    env: node
    region: singapore  # 或 oregon / frankfurt
    plan: free  # 免费套餐
    buildCommand: npm install
    startCommand: npm start
    healthCheckPath: /webapp
    envVars:
      # Telegram 配置
      - key: TELEGRAM_BOT_TOKEN
        sync: false  # 需要在 Render 控制台手动设置

      - key: WEBAPP_URL
        value: https://telegram-video-bot.onrender.com/webapp  # 替换为你的实际域名

      # 服务器配置
      - key: PORT
        value: 3000

      - key: NODE_ENV
        value: production

      - key: API_BASE_URL
        value: https://telegram-video-bot.onrender.com  # 替换为你的实际域名

      # ComfyUI 配置 (通过 Cloudflare Tunnel 或公网地址)
      - key: COMFYUI_URL
        sync: false  # 需要手动设置,填写你的 ComfyUI 公网地址

      - key: COMFYUI_API_URL
        sync: false

      - key: SVD_API_URL
        sync: false

      - key: SVD_API_PORT
        value: 3002

      - key: COGVIDEO_API_URL
        sync: false

      - key: COGVIDEO_API_PORT
        value: 3003

      - key: OUTPUT_DIR
        value: ./output

# 注意事项:
# 1. 免费套餐会在 15 分钟无请求后休眠
# 2. 首次访问需要 10-30 秒启动时间
# 3. 每月有 750 小时运行时间限制
# 4. 需要配合 Cloudflare Tunnel 连接本地 ComfyUI
# 5. 免费套餐不支持持久化磁盘,文件会在重启后清空(适用于临时生成的视频文件)
